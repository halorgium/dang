#!/usr/bin/env ruby

require 'dang'
require 'optparse'

to_eval = nil
path = nil
version = false

opt = OptionParser.new do |o|
  o.banner = "Usage: dang [options] [input.dang] [output.html]"

  o.on "-e STR", "Evaluate the string as Dang" do |s|
    to_eval = s
  end

  o.on "-v", "--version", "Print the version of Dang" do
    puts "dang #{Dang::VERSION}, codename: #{Dang::CODENAME}"
    version = true
  end

  o.on "-h", "--help", "Print, well, this" do
    puts opt
    exit
  end
end

opt.parse! ARGV

if to_eval
  puts Dang.it(to_eval)

else
  path = ARGV.shift
  if !path
    exit if version
    puts opt
    exit 1
  end
  puts Dang.it(File.read(path))
end
